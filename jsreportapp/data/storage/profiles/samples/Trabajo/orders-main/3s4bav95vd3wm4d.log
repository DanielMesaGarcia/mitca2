{"type":"operationStart","subtype":"profile","data":{"_id":"dh4NxGGHFtZgWiKo","timestamp":"2024-02-21T16:37:00.995Z","state":"queued","mode":"standard","creationDate":"2024-02-21T16:37:00.997Z","modificationDate":"2024-02-21T16:37:00.997Z","shortid":"hILQyPt","$entitySet":"profiles"},"doDiffs":false,"timestamp":1708533420996,"id":"ytefn2ysfqu9nn2","previousOperationId":null,"operationId":"wipbw8ukq6wwiw3"}
{"type":"log","level":"info","message":"Render request 3 queued for execution and waiting for available worker","previousOperationId":"wipbw8ukq6wwiw3","timestamp":1708533420996,"id":"ycmbuk6ptnbi29l"}
{"type":"operationStart","subtype":"render","name":"orders-main","previousOperationId":"wipbw8ukq6wwiw3","timestamp":1708533421005,"id":"yebycvfvwn2sk4y","previousEventId":"ytefn2ysfqu9nn2","operationId":"u0ncj92d8f1cujn"}
{"type":"log","timestamp":1708533421006,"level":"info","message":"Starting rendering request 3","meta":{"rootId":"3s4bav95vd3wm4d","id":"3s4bav95vd3wm4d"},"id":"y2z1dc5ifobgx63","previousOperationId":"u0ncj92d8f1cujn"}
{"type":"log","timestamp":1708533421006,"level":"info","message":"Rendering template { name: orders-main, recipe: chrome-pdf, engine: handlebars, preview: true }","meta":{"rootId":"3s4bav95vd3wm4d","id":"3s4bav95vd3wm4d"},"id":"fgpqufin0hr15uu","previousOperationId":"u0ncj92d8f1cujn"}
{"type":"log","timestamp":1708533421007,"level":"debug","message":"Data item not defined for this template.","meta":{"rootId":"3s4bav95vd3wm4d","id":"3s4bav95vd3wm4d"},"id":"6nto2vur0hoyu1n","previousOperationId":"u0ncj92d8f1cujn"}
{"type":"log","timestamp":1708533421009,"level":"debug","message":"Executing script orders-script (beforeRender)","meta":{"rootId":"3s4bav95vd3wm4d","id":"3s4bav95vd3wm4d"},"id":"6rubnjt52a3r5zz","previousOperationId":"u0ncj92d8f1cujn"}
{"type":"log","timestamp":1708533421019,"level":"warn","message":"Error when processing render request 3\n(because) error when evaluating custom script /samples/Trabajo/orders-script\nrequire of \"axios\" module has been blocked. To be able to require custom modules you need to add to configuration { \"trustUserCode\": true } or enable just specific module using { sandbox: { allowedModules\": [\"axios\"] }\n\n(sandbox.js line 1:164)\n\n> 1 | const axios = require('axios');\n    |                                ^\n  2 |\n  3 | function fetchData() {\n  4 |   const apiUrl = 'http://localhost:3001/races';\n\n\nError: require of \"axios\" module has been blocked. To be able to require custom modules you need to add to configuration { \"trustUserCode\": true } or enable just specific module using { sandbox: { allowedModules\": [\"axios\"] }\n  at sandboxRequire (/Users/josemiguelbravomendez/Documents/segundo/Proyecto2fase/Mitca/mitca2/jsreportapp/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/requireSandbox.js:53:19)\n  at Object.require (/Users/josemiguelbravomendez/Documents/segundo/Proyecto2fase/Mitca/mitca2/jsreportapp/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/createSandbox.js:89:30)\n  at eval (sandbox.js:1:164)\n  at async run (/Users/josemiguelbravomendez/Documents/segundo/Proyecto2fase/Mitca/mitca2/jsreportapp/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/createSandbox.js:132:18)\n  at async WorkerReporter.runInSandbox [as _runInSandbox] (/Users/josemiguelbravomendez/Documents/segundo/Proyecto2fase/Mitca/mitca2/jsreportapp/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/runInSandbox.js:195:14)\n  at async executeScript (/Users/josemiguelbravomendez/Documents/segundo/Proyecto2fase/Mitca/mitca2/jsreportapp/node_modules/@jsreport/jsreport-scripts/lib/executeScript.js:122:12)\n  at async Scripts._runScript (/Users/josemiguelbravomendez/Documents/segundo/Proyecto2fase/Mitca/mitca2/jsreportapp/node_modules/@jsreport/jsreport-scripts/lib/worker.js:140:30)\n  at async Scripts.handleBeforeRender (/Users/josemiguelbravomendez/Documents/segundo/Proyecto2fase/Mitca/mitca2/jsreportapp/node_modules/@jsreport/jsreport-scripts/lib/worker.js:64:7)\n  at async ListenerCollection.fire (/Users/josemiguelbravomendez/Documents/segundo/Proyecto2fase/Mitca/mitca2/jsreportapp/node_modules/@jsreport/jsreport-core/lib/shared/listenerCollection.js:157:21)\n  at async beforeRender (/Users/josemiguelbravomendez/Documents/segundo/Proyecto2fase/Mitca/mitca2/jsreportapp/node_modules/@jsreport/jsreport-core/lib/worker/render/render.js:24:5)\n  at async WorkerReporter._render (/Users/josemiguelbravomendez/Documents/segundo/Proyecto2fase/Mitca/mitca2/jsreportapp/node_modules/@jsreport/jsreport-core/lib/worker/render/render.js:141:7)\n  at async /Users/josemiguelbravomendez/Documents/segundo/Proyecto2fase/Mitca/mitca2/jsreportapp/node_modules/@jsreport/jsreport-core/lib/worker/reporter.js:224:19\n  at async processAndResponse (/Users/josemiguelbravomendez/Documents/segundo/Proyecto2fase/Mitca/mitca2/jsreportapp/node_modules/@jsreport/advanced-workers/lib/workerHandler.js:41:17)","meta":{"rootId":"3s4bav95vd3wm4d","id":"3s4bav95vd3wm4d"},"id":"thjvmmzvypaqr0p","previousOperationId":"u0ncj92d8f1cujn"}
{"type":"log","timestamp":1708533421019,"level":"warn","message":"Rendering request 3 finished with error in 24 ms","meta":{"rootId":"3s4bav95vd3wm4d","id":"3s4bav95vd3wm4d"},"id":"6cezhjqilck700j","previousOperationId":"u0ncj92d8f1cujn"}
{"type":"error","timestamp":1708533421020,"statusCode":400,"weak":true,"decoratedSuffix":"\n\n(sandbox.js line 1:164)\n\n> 1 | const axios = require('axios');\n    |                                ^\n  2 |\n  3 | function fetchData() {\n  4 |   const apiUrl = 'http://localhost:3001/races';\n\n","entity":{"shortid":"BJX1Jw82ce","name":"orders-script","content":"const axios = require('axios');\n\nfunction fetchData() {\n  const apiUrl = 'http://localhost:3001/races';\n\n  return axios.get(apiUrl)\n    .then(response => response.data)\n    .catch(error => {\n      console.error('Error fetching data:', error);\n      throw error;\n    });\n}\n\nfunction transformData(data) {\n  const transformedData = data.data.map(race => {\n    const raceRunners = race.runners.map(runner => ({\n      id: runner._id,\n      name: runner.name,\n      phone: runner.phone,\n    }));\n\n    return {\n      country: race._id,\n      city: race.city,\n      eventDate: race.eventDate,\n      length: race.length,\n      runners: raceRunners,\n      runnerCount: race.runners.length,\n      raceNames: race._id,\n      runnerCounts: race.runners.length,\n    };\n  });\n\n  const nombres = transformedData.map(race => race.raceNames);\n  const cuenta = transformedData.map(race => race.runnerCounts);\n\n  console.log(nombres);\n  console.log(cuenta);\n\n  return {\n    nombres: nombres,\n    cuenta: cuenta,\n    info: transformedData,\n  };\n}\n\n\nfunction beforeRender(req, res, done) {\n  fetchData()\n    .then(data => {\n      const transformedData = transformData(data);\n\n      // Assign the transformed data to the 'orders' variable in the template\n      req.data = {\n        orders: transformedData\n      };\n\n      done();\n    })\n    .catch(error => {\n      res.statusCode = 500;\n      res.end(`Error: ${error.message}`);\n    });\n}\n"},"property":"content","logged":true,"previousOperationId":"u0ncj92d8f1cujn","id":"lh0n5ux23pmnfky","stack":"Error: require of \"axios\" module has been blocked. To be able to require custom modules you need to add to configuration { \"trustUserCode\": true } or enable just specific module using { sandbox: { allowedModules\": [\"axios\"] }\n  at sandboxRequire (/Users/josemiguelbravomendez/Documents/segundo/Proyecto2fase/Mitca/mitca2/jsreportapp/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/requireSandbox.js:53:19)\n  at Object.require (/Users/josemiguelbravomendez/Documents/segundo/Proyecto2fase/Mitca/mitca2/jsreportapp/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/createSandbox.js:89:30)\n  at eval (sandbox.js:1:164)\n  at async run (/Users/josemiguelbravomendez/Documents/segundo/Proyecto2fase/Mitca/mitca2/jsreportapp/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/createSandbox.js:132:18)\n  at async WorkerReporter.runInSandbox [as _runInSandbox] (/Users/josemiguelbravomendez/Documents/segundo/Proyecto2fase/Mitca/mitca2/jsreportapp/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/runInSandbox.js:195:14)\n  at async executeScript (/Users/josemiguelbravomendez/Documents/segundo/Proyecto2fase/Mitca/mitca2/jsreportapp/node_modules/@jsreport/jsreport-scripts/lib/executeScript.js:122:12)\n  at async Scripts._runScript (/Users/josemiguelbravomendez/Documents/segundo/Proyecto2fase/Mitca/mitca2/jsreportapp/node_modules/@jsreport/jsreport-scripts/lib/worker.js:140:30)\n  at async Scripts.handleBeforeRender (/Users/josemiguelbravomendez/Documents/segundo/Proyecto2fase/Mitca/mitca2/jsreportapp/node_modules/@jsreport/jsreport-scripts/lib/worker.js:64:7)\n  at async ListenerCollection.fire (/Users/josemiguelbravomendez/Documents/segundo/Proyecto2fase/Mitca/mitca2/jsreportapp/node_modules/@jsreport/jsreport-core/lib/shared/listenerCollection.js:157:21)\n  at async beforeRender (/Users/josemiguelbravomendez/Documents/segundo/Proyecto2fase/Mitca/mitca2/jsreportapp/node_modules/@jsreport/jsreport-core/lib/worker/render/render.js:24:5)\n  at async WorkerReporter._render (/Users/josemiguelbravomendez/Documents/segundo/Proyecto2fase/Mitca/mitca2/jsreportapp/node_modules/@jsreport/jsreport-core/lib/worker/render/render.js:141:7)\n  at async /Users/josemiguelbravomendez/Documents/segundo/Proyecto2fase/Mitca/mitca2/jsreportapp/node_modules/@jsreport/jsreport-core/lib/worker/reporter.js:224:19\n  at async processAndResponse (/Users/josemiguelbravomendez/Documents/segundo/Proyecto2fase/Mitca/mitca2/jsreportapp/node_modules/@jsreport/advanced-workers/lib/workerHandler.js:41:17)","message":"Error when evaluating custom script /samples/Trabajo/orders-script\nrequire of \"axios\" module has been blocked. To be able to require custom modules you need to add to configuration { \"trustUserCode\": true } or enable just specific module using { sandbox: { allowedModules\": [\"axios\"] }\n\n(sandbox.js line 1:164)\n\n> 1 | const axios = require('axios');\n    |                                ^\n  2 |\n  3 | function fetchData() {\n  4 |   const apiUrl = 'http://localhost:3001/races';\n\n"}
