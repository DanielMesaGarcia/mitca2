{"type":"operationStart","subtype":"profile","data":{"_id":"FoIjjKD59oIE09VY","timestamp":"2024-02-19T16:27:44.989Z","state":"queued","mode":"standard","creationDate":"2024-02-19T16:27:44.991Z","modificationDate":"2024-02-19T16:27:44.991Z","shortid":"RiJtkul","$entitySet":"profiles"},"doDiffs":false,"timestamp":1708360064990,"id":"ha2mql7mtoofepk","previousOperationId":null,"operationId":"mxmpb3iz01s6772"}
{"type":"log","level":"info","message":"Render request 12 queued for execution and waiting for available worker","previousOperationId":"mxmpb3iz01s6772","timestamp":1708360064990,"id":"7hk8pw9v2t7e9h4"}
{"type":"operationStart","subtype":"render","name":"orders-main","previousOperationId":"mxmpb3iz01s6772","timestamp":1708360064999,"id":"3wxz4f3lp2vns8t","previousEventId":"ha2mql7mtoofepk","operationId":"opxpjdasfpddaqo"}
{"type":"log","timestamp":1708360064999,"level":"info","message":"Starting rendering request 12","meta":{"rootId":"p4at4hyn874qtka","id":"p4at4hyn874qtka"},"id":"gfm6ijkm1qwn94p","previousOperationId":"opxpjdasfpddaqo"}
{"type":"log","timestamp":1708360065000,"level":"info","message":"Rendering template { name: orders-main, recipe: chrome-pdf, engine: handlebars, preview: true }","meta":{"rootId":"p4at4hyn874qtka","id":"p4at4hyn874qtka"},"id":"9fouixtjo49auk3","previousOperationId":"opxpjdasfpddaqo"}
{"type":"log","timestamp":1708360065001,"level":"debug","message":"Data item not defined for this template.","meta":{"rootId":"p4at4hyn874qtka","id":"p4at4hyn874qtka"},"id":"fzwchx8ycy8p653","previousOperationId":"opxpjdasfpddaqo"}
{"type":"log","timestamp":1708360065003,"level":"debug","message":"Executing script orders-script (beforeRender)","meta":{"rootId":"p4at4hyn874qtka","id":"p4at4hyn874qtka"},"id":"vith2713zcb9me8","previousOperationId":"opxpjdasfpddaqo"}
{"type":"log","timestamp":1708360065024,"level":"warn","message":"Error when processing render request 12\n(because) error when evaluating custom script /samples/Trabajo/orders-script\nUnexpected token ')'\nsandbox.js:56\n;return {topLevelFunctions: {}, fnToExecute: ejampdmtra_executionFn_expose} })()\n                                                                             ^\n\nSyntaxError: Unexpected token ')'\n    at new Script (node:vm:99:7)\n    at doCompileScript (/Users/josemiguelbravomendez/Documents/segundo/Proyecto2fase/Mitca/mitca2/jsreportapp/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/createSandbox.js:154:10)\n    at run (/Users/josemiguelbravomendez/Documents/segundo/Proyecto2fase/Mitca/mitca2/jsreportapp/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/createSandbox.js:135:74)\n    at WorkerReporter.runInSandbox [as _runInSandbox] (/Users/josemiguelbravomendez/Documents/segundo/Proyecto2fase/Mitca/mitca2/jsreportapp/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/runInSandbox.js:195:20)","meta":{"rootId":"p4at4hyn874qtka","id":"p4at4hyn874qtka"},"id":"3iusxi8q71j275k","previousOperationId":"opxpjdasfpddaqo"}
{"type":"log","timestamp":1708360065024,"level":"warn","message":"Rendering request 12 finished with error in 35 ms","meta":{"rootId":"p4at4hyn874qtka","id":"p4at4hyn874qtka"},"id":"m9t16kprcc5fgkg","previousOperationId":"opxpjdasfpddaqo"}
{"type":"error","timestamp":1708360065025,"statusCode":400,"weak":true,"entity":{"shortid":"BJX1Jw82ce","name":"orders-script","content":"const axios = require('axios');\n\nfunction fetchData() {\n  const apiUrl = 'http://localhost:3001/races';\n\n  return axios.get(apiUrl)\n    .then(response => response.data)\n    .catch(error => {\n      console.error('Error fetching data:', error);\n      throw error;\n    });\n}\n\nfunction transformData(data) {\n  const transformedData = data.data.map(race => {\n    const raceRunners = race.runners.map(runner => ({\n      id: runner._id,\n      name: runner.name,\n      phone: runner.phone,\n    }));\n\n    return {\n      country: race._id,\n      city: race.city,\n      eventDate: race.eventDate,\n      length: race.length,\n      runners: raceRunners,\n      runnerCount: race.runners.length,\n      raceNames: race._id,\n      runnerCounts: race.runners.length,\n    };\n  });\n\n \n\n\nfunction beforeRender(req, res, done) {\n  fetchData()\n    .then(data => {\n      const transformedData = transformData(data);\n\n      // Assign the transformed data to the 'orders' variable in the template\n      req.data = {\n        orders: transformedData\n      };\n\n      done();\n    })\n    .catch(error => {\n      res.statusCode = 500;\n      res.end(`Error: ${error.message}`);\n    });\n}\n"},"property":"content","logged":true,"previousOperationId":"opxpjdasfpddaqo","id":"s20xhzjephekct2","stack":"sandbox.js:56\n;return {topLevelFunctions: {}, fnToExecute: ejampdmtra_executionFn_expose} })()\n                                                                             ^\n\nSyntaxError: Unexpected token ')'\n    at new Script (node:vm:99:7)\n    at doCompileScript (/Users/josemiguelbravomendez/Documents/segundo/Proyecto2fase/Mitca/mitca2/jsreportapp/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/createSandbox.js:154:10)\n    at run (/Users/josemiguelbravomendez/Documents/segundo/Proyecto2fase/Mitca/mitca2/jsreportapp/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/createSandbox.js:135:74)\n    at WorkerReporter.runInSandbox [as _runInSandbox] (/Users/josemiguelbravomendez/Documents/segundo/Proyecto2fase/Mitca/mitca2/jsreportapp/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/runInSandbox.js:195:20)","message":"Error when evaluating custom script /samples/Trabajo/orders-script\nUnexpected token ')'"}
