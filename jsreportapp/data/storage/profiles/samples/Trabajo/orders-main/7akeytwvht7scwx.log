{"type":"operationStart","subtype":"profile","data":{"_id":"4eDl8sgnEf35DhHC","timestamp":"2024-01-17T17:09:52.832Z","state":"queued","mode":"standard","creationDate":"2024-01-17T17:09:52.834Z","modificationDate":"2024-01-17T17:09:52.834Z","shortid":"iUxuoSb","$entitySet":"profiles"},"doDiffs":false,"timestamp":1705511392833,"id":"eiwcxg21pieogfu","previousOperationId":null,"operationId":"ccc3stk7kv7blgz"}
{"type":"log","level":"info","message":"Render request 72 queued for execution and waiting for available worker","previousOperationId":"ccc3stk7kv7blgz","timestamp":1705511392833,"id":"hkhp97ravlqkgyh"}
{"type":"operationStart","subtype":"render","name":"orders-main","previousOperationId":"ccc3stk7kv7blgz","timestamp":1705511392839,"id":"v2kvgb5b2b5cjwd","previousEventId":"eiwcxg21pieogfu","operationId":"wcnh304bubb46ip"}
{"type":"log","timestamp":1705511392839,"level":"info","message":"Starting rendering request 72","meta":{"rootId":"7akeytwvht7scwx","id":"7akeytwvht7scwx"},"id":"zbtbkqvvtlh98sm","previousOperationId":"wcnh304bubb46ip"}
{"type":"log","timestamp":1705511392839,"level":"info","message":"Rendering template { name: orders-main, recipe: chrome-pdf, engine: handlebars, preview: true }","meta":{"rootId":"7akeytwvht7scwx","id":"7akeytwvht7scwx"},"id":"1ujzmj50w1mwae6","previousOperationId":"wcnh304bubb46ip"}
{"type":"log","timestamp":1705511392841,"level":"debug","message":"Data item not defined for this template.","meta":{"rootId":"7akeytwvht7scwx","id":"7akeytwvht7scwx"},"id":"jv4nrcldl4xdi4o","previousOperationId":"wcnh304bubb46ip"}
{"type":"log","timestamp":1705511392842,"level":"debug","message":"Executing script orders-script (beforeRender)","meta":{"rootId":"7akeytwvht7scwx","id":"7akeytwvht7scwx"},"id":"0f1wykr7x1v8pvg","previousOperationId":"wcnh304bubb46ip"}
{"type":"log","timestamp":1705511392848,"level":"warn","message":"Error when processing render request 72\n(because) error when evaluating custom script /samples/Trabajo/orders-script\nIdentifier 'jsreport' has already been declared\nsandbox.js:3\nconst jsreport = require('jsreport-core').jsreport();\n      ^\n\nSyntaxError: Identifier 'jsreport' has already been declared\n    at new Script (node:vm:94:7)\n    at doCompileScript (C:\\Users\\Daniel Mesa\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\createSandbox.js:154:10)\n    at run (C:\\Users\\Daniel Mesa\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\createSandbox.js:135:74)\n    at WorkerReporter.runInSandbox [as _runInSandbox] (C:\\Users\\Daniel Mesa\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\runInSandbox.js:195:20)","meta":{"rootId":"7akeytwvht7scwx","id":"7akeytwvht7scwx"},"id":"0yic0yxv9bufcoh","previousOperationId":"wcnh304bubb46ip"}
{"type":"log","timestamp":1705511392848,"level":"warn","message":"Rendering request 72 finished with error in 16 ms","meta":{"rootId":"7akeytwvht7scwx","id":"7akeytwvht7scwx"},"id":"o5gnt30nkbz8ycx","previousOperationId":"wcnh304bubb46ip"}
{"type":"error","timestamp":1705511392849,"statusCode":400,"weak":true,"entity":{"shortid":"BJX1Jw82ce","name":"orders-script","content":"const axios = require('axios');\nconst jsreport = require('jsreport-core')();\nconst jsreport = require('jsreport-core').jsreport();\n\njsreport.use(require('jsreport-handlebars')({\n  helpers: {\n    'JSON.stringify': function(context) {\n      return JSON.stringify(context);\n    }\n  }\n}));\n\nfunction fetchData() {\n  const apiUrl = 'http://localhost:3001/races';\n\n  return axios.get(apiUrl)\n    .then(response => response.data)\n    .catch(error => {\n      console.error('Error fetching data:', error);\n      throw error;\n    });\n}\n\nfunction transformData(data) {\n  return data.data.map(race => {\n    const raceRunners = race.runners.map(runner => ({\n      id: runner._id,\n      name: runner.name,\n      phone: runner.phone,\n    }));\n\n    return {\n      country: race._id,\n      city: race.city,\n      eventDate: race.eventDate,\n      length: race.length,\n      runners: raceRunners,\n      runnerCount: race.runners.length,\n    };\n  });\n}\n\nfunction beforeRender(req, res, done) {\n  fetchData()\n    .then(data => {\n      const transformedData = transformData(data);\n\n      // Assign the transformed data to the 'orders' variable in the template\n      req.data = {\n        orders: transformedData\n      };\n\n      done();\n    })\n    .catch(error => {\n      res.statusCode = 500;\n      res.end(`Error: ${error.message}`);\n    });\n}\n"},"property":"content","logged":true,"previousOperationId":"wcnh304bubb46ip","id":"5q4wwtiihidbfqp","stack":"sandbox.js:3\nconst jsreport = require('jsreport-core').jsreport();\n      ^\n\nSyntaxError: Identifier 'jsreport' has already been declared\n    at new Script (node:vm:94:7)\n    at doCompileScript (C:\\Users\\Daniel Mesa\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\createSandbox.js:154:10)\n    at run (C:\\Users\\Daniel Mesa\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\createSandbox.js:135:74)\n    at WorkerReporter.runInSandbox [as _runInSandbox] (C:\\Users\\Daniel Mesa\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\runInSandbox.js:195:20)","message":"Error when evaluating custom script /samples/Trabajo/orders-script\nIdentifier 'jsreport' has already been declared"}
