{"type":"operationStart","subtype":"profile","data":{"_id":"zTRnsqNsGm2IXyJt","timestamp":"2024-01-18T14:32:13.950Z","state":"queued","mode":"standard","creationDate":"2024-01-18T14:32:13.954Z","modificationDate":"2024-01-18T14:32:13.954Z","shortid":"MsWfKWm","$entitySet":"profiles"},"doDiffs":false,"timestamp":1705588333951,"id":"74x940uxuhbd0db","previousOperationId":null,"operationId":"eldkjaup2q1532s"}
{"type":"log","level":"info","message":"Render request 2 queued for execution and waiting for available worker","previousOperationId":"eldkjaup2q1532s","timestamp":1705588333952,"id":"t28slxdy1ql8gb4"}
{"type":"operationStart","subtype":"render","name":"orders-main","previousOperationId":"eldkjaup2q1532s","timestamp":1705588333974,"id":"lz7ysb5okrpojn4","previousEventId":"74x940uxuhbd0db","operationId":"tdwki03lmuoqsr7"}
{"type":"log","timestamp":1705588333975,"level":"info","message":"Starting rendering request 2","meta":{"rootId":"k2oycbsdpr4u2cq","id":"k2oycbsdpr4u2cq"},"id":"69e4rpax6rjjb0j","previousOperationId":"tdwki03lmuoqsr7"}
{"type":"log","timestamp":1705588333977,"level":"info","message":"Rendering template { name: orders-main, recipe: chrome-pdf, engine: handlebars, preview: true }","meta":{"rootId":"k2oycbsdpr4u2cq","id":"k2oycbsdpr4u2cq"},"id":"woqw2ip7w9hkpdi","previousOperationId":"tdwki03lmuoqsr7"}
{"type":"log","timestamp":1705588333982,"level":"debug","message":"Data item not defined for this template.","meta":{"rootId":"k2oycbsdpr4u2cq","id":"k2oycbsdpr4u2cq"},"id":"srzgfsoir26n2jk","previousOperationId":"tdwki03lmuoqsr7"}
{"type":"log","timestamp":1705588333988,"level":"debug","message":"Executing script orders-script (beforeRender)","meta":{"rootId":"k2oycbsdpr4u2cq","id":"k2oycbsdpr4u2cq"},"id":"fyxypv2k6ug6ir6","previousOperationId":"tdwki03lmuoqsr7"}
{"type":"log","timestamp":1705588334331,"level":"warn","message":"Error when processing render request 2\n(because) error when evaluating custom script /samples/Trabajo/orders-script\nUnexpected token '}'\nsandbox.js:46\n  options: {...}\n               ^\n\nSyntaxError: Unexpected token '}'\n    at new Script (node:vm:94:7)\n    at doCompileScript (C:\\Users\\Daniel Mesa\\Desktop\\proyecto\\mitca\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\createSandbox.js:154:10)\n    at run (C:\\Users\\Daniel Mesa\\Desktop\\proyecto\\mitca\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\createSandbox.js:135:74)\n    at WorkerReporter.runInSandbox [as _runInSandbox] (C:\\Users\\Daniel Mesa\\Desktop\\proyecto\\mitca\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\runInSandbox.js:195:20)","meta":{"rootId":"k2oycbsdpr4u2cq","id":"k2oycbsdpr4u2cq"},"id":"et1quh2phoq8uk6","previousOperationId":"tdwki03lmuoqsr7"}
{"type":"log","timestamp":1705588334331,"level":"warn","message":"Rendering request 2 finished with error in 381 ms","meta":{"rootId":"k2oycbsdpr4u2cq","id":"k2oycbsdpr4u2cq"},"id":"5tdgtm9g43an7ex","previousOperationId":"tdwki03lmuoqsr7"}
{"type":"error","timestamp":1705588334342,"statusCode":400,"weak":true,"entity":{"shortid":"BJX1Jw82ce","name":"orders-script","content":"const axios = require('axios');\n\nfunction fetchData() {\n  const apiUrl = 'http://localhost:3001/races';\n\n  return axios.get(apiUrl)\n    .then(response => response.data)\n    .catch(error => {\n      console.error('Error fetching data:', error);\n      throw error;\n    });\n}\n\nfunction transformData(data) {\n  return data.data.map(race => {\n    const raceRunners = race.runners.map(runner => ({\n      id: runner._id,\n      name: runner.name,\n      phone: runner.phone,\n    }));\n\n    return {\n      country: race._id,\n      city: race.city,\n      eventDate: race.eventDate,\n      length: race.length,\n      runners: raceRunners,\n      runnerCount: race.runners.length,\n    };\n  });\n}\n\nconst xValues = [\"Italy\", \"France\", \"Spain\", \"USA\", \"Argentina\"];\nconst yValues = [55, 49, 44, 24, 15];\nconst barColors = [\"red\", \"green\",\"blue\",\"orange\",\"brown\"];\n\nnew Chart(\"myChart\", {\n  type: \"bar\",\n  data: {\n    labels: xValues,\n    datasets: [{\n      backgroundColor: barColors,\n      data: yValues\n    }]\n  },\n  options: {...}\n});\n\nfunction beforeRender(req, res, done) {\n  fetchData()\n    .then(data => {\n      const transformedData = transformData(data);\n\n      // Assign the transformed data to the 'orders' variable in the template\n      req.data = {\n        orders: transformedData\n      };\n\n      done();\n    })\n    .catch(error => {\n      res.statusCode = 500;\n      res.end(`Error: ${error.message}`);\n    });\n}"},"property":"content","logged":true,"previousOperationId":"tdwki03lmuoqsr7","id":"tqbyjsahgt7dup7","stack":"sandbox.js:46\n  options: {...}\n               ^\n\nSyntaxError: Unexpected token '}'\n    at new Script (node:vm:94:7)\n    at doCompileScript (C:\\Users\\Daniel Mesa\\Desktop\\proyecto\\mitca\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\createSandbox.js:154:10)\n    at run (C:\\Users\\Daniel Mesa\\Desktop\\proyecto\\mitca\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\createSandbox.js:135:74)\n    at WorkerReporter.runInSandbox [as _runInSandbox] (C:\\Users\\Daniel Mesa\\Desktop\\proyecto\\mitca\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\runInSandbox.js:195:20)","message":"Error when evaluating custom script /samples/Trabajo/orders-script\nUnexpected token '}'"}
