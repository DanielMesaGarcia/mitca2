{"type":"operationStart","subtype":"profile","data":{"_id":"k1pJlSHUoRZbm3Iv","timestamp":"2024-01-18T14:32:39.488Z","state":"queued","mode":"standard","creationDate":"2024-01-18T14:32:39.491Z","modificationDate":"2024-01-18T14:32:39.491Z","shortid":"QipyTNv","$entitySet":"profiles"},"doDiffs":false,"timestamp":1705588359489,"id":"rfwixplov58fw7n","previousOperationId":null,"operationId":"rpuhos62obh8ka1"}
{"type":"log","level":"info","message":"Render request 3 queued for execution and waiting for available worker","previousOperationId":"rpuhos62obh8ka1","timestamp":1705588359490,"id":"6cu3wv69tgzuhjx"}
{"type":"operationStart","subtype":"render","name":"orders-main","previousOperationId":"rpuhos62obh8ka1","timestamp":1705588359508,"id":"tmijzi6o8rbfvf4","previousEventId":"rfwixplov58fw7n","operationId":"m7mad9tt0gfmenh"}
{"type":"log","timestamp":1705588359509,"level":"info","message":"Starting rendering request 3","meta":{"rootId":"cqynfmz6tjgs6g7","id":"cqynfmz6tjgs6g7"},"id":"28wgwbtbgw2av4b","previousOperationId":"m7mad9tt0gfmenh"}
{"type":"log","timestamp":1705588359509,"level":"info","message":"Rendering template { name: orders-main, recipe: chrome-pdf, engine: handlebars, preview: true }","meta":{"rootId":"cqynfmz6tjgs6g7","id":"cqynfmz6tjgs6g7"},"id":"d8f194yvsps8x7h","previousOperationId":"m7mad9tt0gfmenh"}
{"type":"log","timestamp":1705588359511,"level":"debug","message":"Data item not defined for this template.","meta":{"rootId":"cqynfmz6tjgs6g7","id":"cqynfmz6tjgs6g7"},"id":"z57vhjm035vj52f","previousOperationId":"m7mad9tt0gfmenh"}
{"type":"log","timestamp":1705588359517,"level":"debug","message":"Executing script orders-script (beforeRender)","meta":{"rootId":"cqynfmz6tjgs6g7","id":"cqynfmz6tjgs6g7"},"id":"6kwow5b0kpbjujq","previousOperationId":"m7mad9tt0gfmenh"}
{"type":"log","timestamp":1705588359601,"level":"warn","message":"Error when processing render request 3\n(because) error when evaluating custom script /samples/Trabajo/orders-script\nChart is not defined\n\n(sandbox.js line 37:1)\n\n  35 | const barColors = [\"red\", \"green\",\"blue\",\"orange\",\"brown\"];\n  36 |\n> 37 | new Chart(\"myChart\", {\n     | ^\n  38 |   type: \"bar\",\n  39 |   data: {\n  40 |     labels: xValues,\n\n\nReferenceError: Chart is not defined\n    at sandbox.js:37:1","meta":{"rootId":"cqynfmz6tjgs6g7","id":"cqynfmz6tjgs6g7"},"id":"rczle9pfrts0skd","previousOperationId":"m7mad9tt0gfmenh"}
{"type":"log","timestamp":1705588359602,"level":"warn","message":"Rendering request 3 finished with error in 114 ms","meta":{"rootId":"cqynfmz6tjgs6g7","id":"cqynfmz6tjgs6g7"},"id":"4ye4tcx44l1u7c0","previousOperationId":"m7mad9tt0gfmenh"}
{"type":"error","timestamp":1705588359611,"statusCode":400,"weak":true,"lineNumber":37,"decoratedSuffix":"\n\n(sandbox.js line 37:1)\n\n  35 | const barColors = [\"red\", \"green\",\"blue\",\"orange\",\"brown\"];\n  36 |\n> 37 | new Chart(\"myChart\", {\n     | ^\n  38 |   type: \"bar\",\n  39 |   data: {\n  40 |     labels: xValues,\n\n","entity":{"shortid":"BJX1Jw82ce","name":"orders-script","content":"const axios = require('axios');\n\nfunction fetchData() {\n  const apiUrl = 'http://localhost:3001/races';\n\n  return axios.get(apiUrl)\n    .then(response => response.data)\n    .catch(error => {\n      console.error('Error fetching data:', error);\n      throw error;\n    });\n}\n\nfunction transformData(data) {\n  return data.data.map(race => {\n    const raceRunners = race.runners.map(runner => ({\n      id: runner._id,\n      name: runner.name,\n      phone: runner.phone,\n    }));\n\n    return {\n      country: race._id,\n      city: race.city,\n      eventDate: race.eventDate,\n      length: race.length,\n      runners: raceRunners,\n      runnerCount: race.runners.length,\n    };\n  });\n}\n\nconst xValues = [\"Italy\", \"France\", \"Spain\", \"USA\", \"Argentina\"];\nconst yValues = [55, 49, 44, 24, 15];\nconst barColors = [\"red\", \"green\",\"blue\",\"orange\",\"brown\"];\n\nnew Chart(\"myChart\", {\n  type: \"bar\",\n  data: {\n    labels: xValues,\n    datasets: [{\n      backgroundColor: barColors,\n      data: yValues\n    }]\n  },\n  options: {}\n});\n\nfunction beforeRender(req, res, done) {\n  fetchData()\n    .then(data => {\n      const transformedData = transformData(data);\n\n      // Assign the transformed data to the 'orders' variable in the template\n      req.data = {\n        orders: transformedData\n      };\n\n      done();\n    })\n    .catch(error => {\n      res.statusCode = 500;\n      res.end(`Error: ${error.message}`);\n    });\n}"},"property":"content","logged":true,"previousOperationId":"m7mad9tt0gfmenh","id":"xwzng8vzjqs1n8u","stack":"ReferenceError: Chart is not defined\n    at sandbox.js:37:1","message":"Error when evaluating custom script /samples/Trabajo/orders-script\nChart is not defined\n\n(sandbox.js line 37:1)\n\n  35 | const barColors = [\"red\", \"green\",\"blue\",\"orange\",\"brown\"];\n  36 |\n> 37 | new Chart(\"myChart\", {\n     | ^\n  38 |   type: \"bar\",\n  39 |   data: {\n  40 |     labels: xValues,\n\n"}
